<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:shared="clr-namespace:Efarming_Sustainability.App.Views.Shared"
             x:Class="Efarming_Sustainability.App.Views.Farms.IndexFarms"
             Title=""
             BackgroundColor="{StaticResource Primary}">
    <Grid RowDefinitions="Auto,*">
        <shared:BasePages Grid.Row="0" Title="Busqueda Fincas"/>
        <ScrollView Grid.Row="1">
        <VerticalStackLayout Grid.Row="1" Spacing="25" Padding="30" VerticalOptions="Start">
            
            <Picker x:Name="dptPicker"
                    Title="Seleccione una Departamento"
                    BackgroundColor="White"
                    TextColor="Black"
                    TitleColor="Gray" />


            <Picker x:Name="mcppicker"
                Title="Seleccione una Municipio"
                BackgroundColor="White"
                TextColor="Black"
                TitleColor="Gray" />

            <Picker x:Name="vilpicker"
                Title="Seleccione una vereda"
                BackgroundColor="White"
                TextColor="Black"
                TitleColor="Gray" />

            <Label Text="Codigo" TextColor="Black"/>
            <Entry Text="{Binding Code}" TextColor="Black" IsReadOnly="false"  BackgroundColor="White"/>

            <Button Text="Buscar Finca" BackgroundColor="#2E7D32" TextColor="White" Clicked="OnSearchFarmClicked"/>

            <BoxView HeightRequest="1" Color="Gray" Margin="0, 10, 0, 10"/>


            <Label Text="Resultados de la Búsqueda" FontSize="Medium" FontAttributes="Bold" TextColor="Black"/>

                <CollectionView ItemsSource="{Binding Items}">
                <CollectionView.Header>
                    <Grid Padding="10" ColumnDefinitions="*,2*,Auto" BackgroundColor="#388E3C">
                        <Label Grid.Column="0" Text="CÓDIGO" FontAttributes="Bold" TextColor="White"/>
                        <Label Grid.Column="1" Text="NOMBRE" FontAttributes="Bold" TextColor="White"/>
                        <Label Grid.Column="2" Text="ACCIONES" FontAttributes="Bold" TextColor="White"/>
                    </Grid>
                </CollectionView.Header>

                <CollectionView.ItemTemplate>
                    <DataTemplate>
                        <Grid Padding="10" ColumnDefinitions="*,2*,Auto" BackgroundColor="White" Margin="0, 0, 0, 1">
                            <Label Grid.Column="0" Text="{Binding Code}" TextColor="Black"/>
                            <Label Grid.Column="1" Text="{Binding Name}" TextColor="Black"/>
                                <HorizontalStackLayout Grid.Column="2" Spacing="5" VerticalOptions="Center">
                                    <Button Text="Descargar" 
                                        WidthRequest="80" 
                                        HeightRequest="35"
                                        FontSize="10"
                                        BackgroundColor="#2E7D32" 
                                        TextColor="White"
                                        CornerRadius="5"
                                        Clicked="OnDownloadFarmClicked"
                                        CommandParameter="{Binding}"/>     

                                </HorizontalStackLayout>
                            </Grid>
                    </DataTemplate>
                </CollectionView.ItemTemplate>

                <CollectionView.EmptyView>
                    <Label Text="No se encontraron fincas con los criterios de búsqueda." TextColor="Gray" HorizontalOptions="Center" VerticalOptions="Center"/>
                </CollectionView.EmptyView>

            </CollectionView>


        </VerticalStackLayout>
        </ScrollView>
    </Grid>
</ContentPage>